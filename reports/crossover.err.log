Traceback (most recent call last):
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\jupyter_core\utils\__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "C:\Users\pmarshal\Anaconda3\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\pmarshal\Anaconda3\lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
just_2023 = danger_filter.loc[(danger_filter['year']==2023)]
rating_counts = just_2023['rating'].value_counts()
#rating_counts_df = pd.DataFrame({'Rating': rating_counts.index, 'Count': rating_counts.values})
# Define a custom order for the ratings
custom_order = ['Very Low', 'Low', 'Moderate', 'High', 'Extreme']

# Apply the custom order and sort the DataFrame
rating_counts_df['Rating'] = pd.Categorical(rating_counts_df['Rating'], categories=custom_order, ordered=True)
rating_counts_df = rating_counts_df.sort_values('Rating')

# Define the mapping of 'Rating' to numerical values
rating_mapping = {'Very Low': 1, 'Low': 2, 'Moderate': 3, 'High': 4, 'Extreme': 5}

# Add the 'danger' column based on the mapping
rating_counts_df['danger'] = rating_counts_df['Rating'].map(rating_mapping)
rating_counts_df
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mNameError[0m                                 Traceback (most recent call last)
Cell [1;32mIn[17], line 8[0m
[0;32m      5[0m custom_order [38;5;241m=[39m [[38;5;124m'[39m[38;5;124mVery Low[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mLow[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mModerate[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mHigh[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mExtreme[39m[38;5;124m'[39m]
[0;32m      7[0m [38;5;66;03m# Apply the custom order and sort the DataFrame[39;00m
[1;32m----> 8[0m rating_counts_df[[38;5;124m'[39m[38;5;124mRating[39m[38;5;124m'[39m] [38;5;241m=[39m pd[38;5;241m.[39mCategorical([43mrating_counts_df[49m[[38;5;124m'[39m[38;5;124mRating[39m[38;5;124m'[39m], categories[38;5;241m=[39mcustom_order, ordered[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[0;32m      9[0m rating_counts_df [38;5;241m=[39m rating_counts_df[38;5;241m.[39msort_values([38;5;124m'[39m[38;5;124mRating[39m[38;5;124m'[39m)
[0;32m     11[0m [38;5;66;03m# Define the mapping of 'Rating' to numerical values[39;00m

[1;31mNameError[0m: name 'rating_counts_df' is not defined

